from torch.utils.data import Dataset
import os
import pickle
from datasets import Dataset

def load_data(args):
    code = pickle.load(open(os.path.join("data", args.dataset, '{}.pkl'.format(args.use_data)),'rb'))
    trainset = Dataset.from_dict({"text": code})
    return trainset    


class SeqhDataSet(Dataset):
    def __init__(self, text):
        super().__init__()
        self.text = text
        
    def __len__(self):
        return len(self.text)
    
    def __getitem__(self, idx): 
        return {"input_ids": self.text[idx]}
